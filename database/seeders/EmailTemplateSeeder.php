<?php

namespace Database\Seeders;

use App\Models\EmailTemplate;
use App\Models\EmailTemplateLang;
use App\Models\UserEmailTemplate;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class EmailTemplateSeeder extends Seeder
{
    public function run(): void
    {
        $languages = json_decode(file_get_contents(resource_path('lang/language.json')), true);
        $langCodes = collect($languages)->pluck('code')->toArray();

        $templates = [
            [
                'name' => 'Company Registration Welcome',
                'from' => 'Advocate Team',
                'translations' => [
                    'en' => [
                        'subject' => 'Welcome to Advocate - Your Legal Practice Management Platform',
                        'content' => '<div style="max-width: 600px; margin: 0 auto; font-family: Georgia, serif; background: #ffffff; border: 1px solid #e0e0e0;"><div style="background: {theme_color}; color: white; padding: 30px; text-align: center;"><h1 style="margin: 0; font-size: 28px; font-weight: bold;">Welcome to Advocate!</h1><p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.9;">Your Legal Practice Management Journey Begins</p></div><div style="padding: 30px;"><p style="color: #374151; font-size: 16px; line-height: 1.6; margin-bottom: 20px;">Dear {user_name},</p><p style="color: #374151; line-height: 1.6; margin-bottom: 20px;">Congratulations! Your Advocate account has been successfully created. You now have access to our comprehensive legal practice management platform designed specifically for legal professionals.</p><div style="background: #f8fafc; border-left: 4px solid {theme_color}; padding: 20px; margin: 25px 0;"><h3 style="color: {theme_color}; margin: 0 0 15px 0; font-size: 18px;">ğŸ¯ Your Account Details</h3><ul style="color: #374151; line-height: 1.8; margin: 0; padding-left: 20px;"><li><strong>Email:</strong> {user_email}</li><li><strong>Account Type:</strong> {user_type}</li><li><strong>Login URL:</strong> <a href="{app_url}" style="color: {theme_color};">{app_url}</a></li></ul></div><div style="background: #ecfdf5; border: 1px solid #d1fae5; border-radius: 8px; padding: 20px; margin: 25px 0;"><h3 style="color: #065f46; margin: 0 0 15px 0; font-size: 18px;">ğŸš€ What You Can Do Next</h3><ul style="color: #047857; line-height: 1.8; margin: 0; padding-left: 20px;"><li>Complete your company profile setup</li><li>Add your practice areas and specializations</li><li>Start managing your cases and clients</li><li>Explore our comprehensive legal tools</li></ul></div><div style="text-align: center; margin: 30px 0;"><a href="{app_url}" style="background: {theme_color}; color: white; padding: 15px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-block; font-size: 16px;">Access Your Dashboard</a></div><p style="color: #6b7280; line-height: 1.6; margin-top: 30px;">If you have any questions or need assistance, our support team is here to help you get started.</p></div><div style="background: #f3f4f6; padding: 20px; border-top: 1px solid #e5e7eb; text-align: center;"><p style="color: #6b7280; font-size: 14px; margin: 0;">Welcome to the Advocate family!</p><p style="color: #6b7280; font-size: 12px; margin: 10px 0 0 0;">Â© 2025 Advocate - Legal Practice Management Platform</p></div></div>'
                    ],
                    'es' => [
                        'subject' => 'Bienvenido a Advocate - Su Plataforma de GestiÃ³n de PrÃ¡ctica Legal',
                        'content' => '<div style="max-width: 600px; margin: 0 auto; font-family: Georgia, serif; background: #ffffff; border: 1px solid #e0e0e0;"><div style="background: linear-gradient(135deg, #10B981 0%, #3b82f6 100%); color: white; padding: 30px; text-align: center;"><h1 style="margin: 0; font-size: 28px; font-weight: bold;">Â¡Bienvenido a Advocate!</h1><p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.9;">Su Viaje de GestiÃ³n de PrÃ¡ctica Legal Comienza</p></div><div style="padding: 30px;"><p style="color: #374151; font-size: 16px; line-height: 1.6; margin-bottom: 20px;">Estimado {user_name},</p><p style="color: #374151; line-height: 1.6; margin-bottom: 20px;">Â¡Felicitaciones! Su cuenta de Advocate ha sido creada exitosamente. Ahora tiene acceso a nuestra plataforma integral de gestiÃ³n de prÃ¡ctica legal diseÃ±ada especÃ­ficamente para profesionales legales.</p><div style="background: #f8fafc; border-left: 4px solid #3b82f6; padding: 20px; margin: 25px 0;"><h3 style="color: #10B981; margin: 0 0 15px 0; font-size: 18px;">ğŸ¯ Detalles de su Cuenta</h3><ul style="color: #374151; line-height: 1.8; margin: 0; padding-left: 20px;"><li><strong>Email:</strong> {user_email}</li><li><strong>Tipo de Cuenta:</strong> {user_type}</li><li><strong>URL de Acceso:</strong> <a href="{app_url}" style="color: #3b82f6;">{app_url}</a></li></ul></div><div style="background: #ecfdf5; border: 1px solid #d1fae5; border-radius: 8px; padding: 20px; margin: 25px 0;"><h3 style="color: #065f46; margin: 0 0 15px 0; font-size: 18px;">ğŸš€ QuÃ© Puede Hacer a ContinuaciÃ³n</h3><ul style="color: #047857; line-height: 1.8; margin: 0; padding-left: 20px;"><li>Complete la configuraciÃ³n del perfil de su empresa</li><li>Agregue sus Ã¡reas de prÃ¡ctica y especializaciones</li><li>Comience a gestionar sus casos y clientes</li><li>Explore nuestras herramientas legales integrales</li></ul></div><div style="text-align: center; margin: 30px 0;"><a href="{app_url}" style="background: #3b82f6; color: white; padding: 15px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-block; font-size: 16px;">Acceder a su Panel</a></div><p style="color: #6b7280; line-height: 1.6; margin-top: 30px;">Si tiene alguna pregunta o necesita asistencia, nuestro equipo de soporte estÃ¡ aquÃ­ para ayudarle a comenzar.</p></div><div style="background: #f3f4f6; padding: 20px; border-top: 1px solid #e5e7eb; text-align: center;"><p style="color: #6b7280; font-size: 14px; margin: 0;">Â¡Bienvenido a la familia Advocate!</p><p style="color: #6b7280; font-size: 12px; margin: 10px 0 0 0;">Â© 2025 Advocate - Plataforma de GestiÃ³n de PrÃ¡ctica Legal</p></div></div>'
                    ]
                ]
            ],
            [
                'name' => 'Newsletter',
                'from' => env('APP_NAME'),
                'translations' => [
                    'en' => [
                        'subject' => 'Legal Updates & Insights from Advocate',
                        'content' => '<div style="max-width: 600px; margin: 0 auto; font-family: Georgia, serif; background: #ffffff; border: 1px solid #e0e0e0;"><div style="background: linear-gradient(135deg, #10B981 0%, #3b82f6 100%); color: white; padding: 30px; text-align: center;"><h1 style="margin: 0; font-size: 28px; font-weight: bold;">Advocate Legal Newsletter</h1><p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.9;">Your Trusted Legal Practice Management Partner</p></div><div style="padding: 30px;"><div style="background: #f8fafc; border-left: 4px solid #3b82f6; padding: 20px; margin-bottom: 25px;"><h2 style="color: #10B981; margin: 0 0 15px 0; font-size: 22px;">ğŸ“š Latest Legal Updates</h2><p style="color: #374151; line-height: 1.6; margin: 0;">Stay informed with the latest developments in legal practice, case management strategies, and regulatory changes that impact your firm.</p></div><div style="margin-bottom: 25px;"><h3 style="color: #10B981; font-size: 18px; margin-bottom: 15px;">ğŸ›ï¸ Practice Management Tips</h3><ul style="color: #374151; line-height: 1.6; padding-left: 20px;"><li>Streamline your case documentation process</li><li>Optimize client communication workflows</li><li>Enhance court schedule management</li><li>Improve billing and time tracking efficiency</li></ul></div><div style="background: #ecfdf5; border: 1px solid #d1fae5; border-radius: 8px; padding: 20px; margin-bottom: 25px;"><h3 style="color: #065f46; margin: 0 0 10px 0; font-size: 18px;">âš–ï¸ Featured Legal Resources</h3><p style="color: #047857; margin: 0; line-height: 1.6;">Access our comprehensive library of legal templates, case precedents, and compliance guidelines to enhance your practice efficiency.</p></div><div style="text-align: center; margin: 30px 0;"><a href="{app_url}" style="background: #3b82f6; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-block;">Access Your Dashboard</a></div></div><div style="background: #f3f4f6; padding: 20px; border-top: 1px solid #e5e7eb; text-align: center;"><p style="color: #6b7280; font-size: 14px; margin: 0 0 10px 0;">You are receiving this newsletter because you subscribed to Advocate updates.</p><p style="color: #6b7280; font-size: 12px; margin: 0;">Email sent to: {subscriber_email} | Â© 2025 Advocate - Legal Practice Management</p></div></div>'
                    ],
                    'es' => [
                        'subject' => 'Actualizaciones Legales e InformaciÃ³n de Advocate',
                        'content' => '<div style="max-width: 600px; margin: 0 auto; font-family: Georgia, serif; background: #ffffff; border: 1px solid #e0e0e0;"><div style="background: linear-gradient(135deg, #10B981 0%, #3b82f6 100%); color: white; padding: 30px; text-align: center;"><h1 style="margin: 0; font-size: 28px; font-weight: bold;">BoletÃ­n Legal Advocate</h1><p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.9;">Su Socio Confiable en GestiÃ³n de PrÃ¡ctica Legal</p></div><div style="padding: 30px;"><div style="background: #f8fafc; border-left: 4px solid #3b82f6; padding: 20px; margin-bottom: 25px;"><h2 style="color: #10B981; margin: 0 0 15px 0; font-size: 22px;">ğŸ“š Ãšltimas Actualizaciones Legales</h2><p style="color: #374151; line-height: 1.6; margin: 0;">MantÃ©ngase informado con los Ãºltimos desarrollos en prÃ¡ctica legal, estrategias de gestiÃ³n de casos y cambios regulatorios que impactan su firma.</p></div><div style="margin-bottom: 25px;"><h3 style="color: #10B981; font-size: 18px; margin-bottom: 15px;">ğŸ›ï¸ Consejos de GestiÃ³n de PrÃ¡ctica</h3><ul style="color: #374151; line-height: 1.6; padding-left: 20px;"><li>Optimice su proceso de documentaciÃ³n de casos</li><li>Mejore los flujos de comunicaciÃ³n con clientes</li><li>Perfeccione la gestiÃ³n de horarios judiciales</li><li>Incremente la eficiencia en facturaciÃ³n y seguimiento de tiempo</li></ul></div><div style="background: #ecfdf5; border: 1px solid #d1fae5; border-radius: 8px; padding: 20px; margin-bottom: 25px;"><h3 style="color: #065f46; margin: 0 0 10px 0; font-size: 18px;">âš–ï¸ Recursos Legales Destacados</h3><p style="color: #047857; margin: 0; line-height: 1.6;">Acceda a nuestra biblioteca integral de plantillas legales, precedentes de casos y guÃ­as de cumplimiento para mejorar la eficiencia de su prÃ¡ctica.</p></div><div style="text-align: center; margin: 30px 0;"><a href="{app_url}" style="background: #3b82f6; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-block;">Acceder a su Panel</a></div></div><div style="background: #f3f4f6; padding: 20px; border-top: 1px solid #e5e7eb; text-align: center;"><p style="color: #6b7280; font-size: 14px; margin: 0 0 10px 0;">EstÃ¡ recibiendo este boletÃ­n porque se suscribiÃ³ a las actualizaciones de Advocate.</p><p style="color: #6b7280; font-size: 12px; margin: 0;">Correo enviado a: {subscriber_email} | Â© 2025 Advocate - GestiÃ³n de PrÃ¡ctica Legal</p></div></div>'
                    ]
                ]
            ],
            [
                'name' => 'Invoice Email',
                'from' => env('APP_NAME'),
                'translations' => [
                    'en' => [
                        'subject' => 'Invoice #{invoice_number} from {company_name} - ${total_amount} Due',
                        'content' => '<div style="max-width: 650px; margin: 0 auto; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);"><div style="background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); color: white; padding: 32px 24px; text-align: center;"><div style="background: rgba(255,255,255,0.1); width: 64px; height: 64px; border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center;"><svg width="32" height="32" fill="currentColor" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/><polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10,9 9,9 8,9"/></svg></div><h1 style="margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.025em;">Invoice #{invoice_number}</h1><p style="margin: 8px 0 0 0; font-size: 16px; opacity: 0.9; font-weight: 500;">From {company_name}</p></div><div style="padding: 32px 24px;"><div style="margin-bottom: 24px;"><h2 style="color: #1f2937; font-size: 20px; font-weight: 600; margin: 0 0 8px 0;">Dear {client_name},</h2><p style="color: #6b7280; font-size: 16px; line-height: 1.6; margin: 0;">We hope this email finds you well. Please find your invoice details below for the legal services we have provided.</p></div><div style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px; margin: 24px 0;"><div style="display: flex; align-items: center; margin-bottom: 16px;"><div style="background: #3b82f6; width: 8px; height: 8px; border-radius: 50%; margin-right: 12px;"></div><h3 style="color: #1e40af; font-size: 18px; font-weight: 600; margin: 0;">Invoice Summary</h3></div><div style="display: grid; gap: 12px;"><div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><span style="color: #64748b; font-weight: 500;">Invoice Number:</span><span style="color: #1f2937; font-weight: 600;">{invoice_number}</span></div><div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><span style="color: #64748b; font-weight: 500;">Invoice Date:</span><span style="color: #1f2937; font-weight: 600;">{invoice_date}</span></div><div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><span style="color: #64748b; font-weight: 500;">Due Date:</span><span style="color: #dc2626; font-weight: 600;">{due_date}</span></div><div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; background: #fef3c7; margin: 8px -12px -12px; border-radius: 0 0 8px 8px; padding-left: 12px; padding-right: 12px;"><span style="color: #92400e; font-weight: 600; font-size: 16px;">Total Amount:</span><span style="color: #92400e; font-weight: 700; font-size: 20px;">{currency_symbol}{total_amount}</span></div></div></div><div style="text-align: center; margin: 32px 0;"><a href="{payment_url}" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 16px 32px; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 16px; display: inline-block; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); transition: all 0.2s;">ğŸ’³ Pay Invoice Online</a><p style="color: #6b7280; font-size: 14px; margin: 12px 0 0 0;">Click the button above to pay securely online</p></div><div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 24px 0;"><h4 style="color: #374151; font-size: 16px; font-weight: 600; margin: 0 0 12px 0; display: flex; align-items: center;"><svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" style="margin-right: 8px;"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>Payment Options:</h4><ul style="color: #6b7280; font-size: 14px; line-height: 1.6; margin: 0; padding-left: 20px;"><li>Secure online payment via credit card or digital wallet</li><li>Bank transfer (contact us for details)</li><li>Check payment (mail to our office address)</li></ul></div><div style="border-top: 1px solid #e5e7eb; padding-top: 24px; margin-top: 32px;"><p style="color: #6b7280; font-size: 14px; line-height: 1.6; margin: 0 0 16px 0;">If you have any questions about this invoice or need to discuss payment arrangements, please don\'t hesitate to contact us. We appreciate your business and look forward to continuing our professional relationship.</p><p style="color: #374151; font-size: 16px; font-weight: 600; margin: 0;">Best regards,<br><span style="color: #1e40af;">{company_name} Team</span></p></div></div><div style="background: #f9fafb; padding: 24px; text-align: center; border-top: 1px solid #e5e7eb;"><p style="color: #6b7280; font-size: 12px; margin: 0 0 8px 0;">This is an automated invoice from {company_name}</p><p style="color: #9ca3af; font-size: 11px; margin: 0;">Â© 2025 {company_name}. All rights reserved.</p></div></div>'
                    ]
                ]
            ]
        ];

        foreach ($templates as $templateData) {
            $template = EmailTemplate::create([
                'name' => $templateData['name'],
                'from' => $templateData['from'],
                'user_id' => 1
            ]);

            foreach ($langCodes as $langCode) {
                $translation = $templateData['translations'][$langCode] ?? $templateData['translations']['en'];
                
                EmailTemplateLang::create([
                    'parent_id' => $template->id,
                    'lang' => $langCode,
                    'subject' => $translation['subject'],
                    'content' => $translation['content']
                ]);
            }

            UserEmailTemplate::create([
                'template_id' => $template->id,
                'user_id' => 1,
                'is_active' => true
            ]);
        }
    }
}
